<!DOCTYPE html>
<html>
<head>
  <style>body{margin: 0;padding: 10px;overflow: auto}#out{margin:0}</style>
  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('/assets/js/sw.js');
      })
    }
  </script>
  <script src="https://wy-lang.org/dist/execute.js"></script>
</head>
<body>
<pre id="out"></pre>
<script>
const outdiv = document.getElementById('out')

window.addEventListener('message', (e) => {
  // console.log(e.data)
  const { text, code, options } = e.data
  
  if (text)
    outdiv.innerText = text
  
  if (code) {
    outdiv.innerText = ""
    try {
      Wenyan.evalCompiled(code, {
        ...options,
        output: (...args) => outdiv.innerText += args.join(" ") + "\n"
      });
    } catch (e) {
      outdiv.innerText = e.toString();
      console.error(e);
    }
  }
}, false);
</script>
</body>
</html>